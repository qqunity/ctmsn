# Лабораторная работа 3. Создание и вычисление формул в трёхзначной логике

**Предметная область:** Университет (сценарий lab3_formulas)

**Система:** CTMSN (Composable Typed Modules for Semantic Networks)

## Содержание

- [Цель работы](#1-цель-работы)
- [Теоретические сведения](#2-теоретические-сведения)
- [Требования к оборудованию и ПО](#3-требования-к-оборудованию-и-по)
- [Порядок выполнения](#4-порядок-выполнения)
- [Задание для самостоятельной работы](#5-задание-для-самостоятельной-работы)
- [Требования к отчёту](#6-требования-к-отчёту)
- [Контрольные вопросы](#7-контрольные-вопросы)

---

## 1 Цель работы

Освоить практические навыки создания логических формул и их вычисления в трёхзначной логике Клини с использованием веб-интерфейса системы CTMSN: построение атомарных и составных формул, интерпретация результатов TRUE, FALSE, UNKNOWN.

## 2 Теоретические сведения

### 2.1 Трёхзначная логика Клини

В системе CTMSN используется сильная трёхзначная логика Клини. Каждая формула может принимать одно из трёх значений:

| Значение | Обозначение | Описание                                         |
|----------|-------------|--------------------------------------------------|
| TRUE     | T           | Формула истинна                                  |
| FALSE    | F           | Формула ложна                                    |
| UNKNOWN  | U           | Истинность не может быть определена              |

Значение UNKNOWN возникает, когда формула содержит переменные, не определённые в текущем контексте, и результат зависит от конкретного значения этих переменных.

### 2.2 Атомарные формулы

Атомарная формула — элементарное логическое высказывание, не содержащее связок.

**FactAtom** — проверяет наличие факта в семантической сети:
- Синтаксис: `FactAtom("predicate_name", arg0, arg1, ...)`
- Результат TRUE, если факт с указанным предикатом и аргументами присутствует в сети.
- Результат FALSE, если факт заведомо отсутствует.
- Результат UNKNOWN, если один из аргументов — неопределённая переменная и результат зависит от её значения.

**EqAtom** — проверяет равенство двух термов:
- Синтаксис: `EqAtom(left, right)`
- Результат TRUE, если оба терма ссылаются на один и тот же концепт.
- Результат FALSE, если термы заведомо различны.
- Результат UNKNOWN, если один из термов — неопределённая переменная.

### 2.3 Логические связки

Составные формулы строятся из атомарных с помощью логических связок. Таблицы истинности приведены ниже.

**NOT (отрицание):**

| A | ¬A |
|---|-----|
| T | F   |
| F | T   |
| U | U   |

**AND (конъюнкция):**

| A | B | A ∧ B |
|---|---|-------|
| T | T | T     |
| T | F | F     |
| T | U | U     |
| F | T | F     |
| F | F | F     |
| F | U | F     |
| U | T | U     |
| U | F | F     |
| U | U | U     |

**OR (дизъюнкция):**

| A | B | A ∨ B |
|---|---|-------|
| T | T | T     |
| T | F | T     |
| T | U | T     |
| F | T | T     |
| F | F | F     |
| F | U | U     |
| U | T | T     |
| U | F | U     |
| U | U | U     |

**IMPLIES (импликация):**

| A | B | A → B |
|---|---|-------|
| T | T | T     |
| T | F | F     |
| T | U | U     |
| F | T | T     |
| F | F | T     |
| F | U | T     |
| U | T | T     |
| U | F | U     |
| U | U | U     |

### 2.4 Вычисление формул (Evaluator)

Вычислитель (Evaluator) принимает на вход:
- Семантическую сеть (набор фактов).
- Контекст (частичное присваивание переменных).
- Формулу.

Вычисление производится рекурсивно: для атомарных формул проверяется наличие факта или равенство термов; для составных — применяются таблицы истинности связок к результатам вычисления подформул.

### 2.5 Предметная область «Университет»

Сценарий `lab3_formulas` использует ту же предметную область, что и `lab1_university`:

**Концепты (6):**

| ID          | Описание                       |
|-------------|--------------------------------|
| university  | Университет                    |
| dept_cs     | Кафедра ИВТ                    |
| course_db   | Курс «Базы данных»            |
| course_ai   | Курс «Искусственный интеллект»|
| ivanov      | Преподаватель Иванов           |
| petrov      | Студент Петров                 |

**Предикаты (5, бинарные):**

| Имя         | Роли                  | Описание            |
|-------------|-----------------------|----------------------|
| belongs_to  | (part, whole)         | Принадлежит          |
| teaches     | (teacher, course)     | Преподаёт            |
| enrolled_in | (student, course)     | Записан на курс      |
| works_at    | (person, place)       | Работает в           |
| studies_at  | (student, department) | Учится на кафедре    |

**Переменные (3):**

| Имя     | Домен                    | Начальное значение |
|---------|--------------------------|--------------------|
| student | {petrov}                 | (не задано)        |
| course  | {course_db, course_ai}   | course_db          |
| teacher | {ivanov}                 | (не задано)        |

Переменная `course` имеет два значения в домене, но в начальном контексте задано только `course_db`. Это позволяет получить результат UNKNOWN для формул, зависящих от обоих возможных значений.

## 3 Требования к оборудованию и ПО

- Компьютер с доступом в интернет
- Веб-браузер (Chrome, Firefox, Safari, Edge)
- Доступ к сайту https://ctmsn.ru

## 4 Порядок выполнения

### 4.1 Вход в систему

1. Откройте в браузере сайт https://ctmsn.ru.
2. Войдите в систему, используя учётную запись, созданную в Лабораторной работе 1.
3. При необходимости зарегистрируйтесь (формат логина: `Фамилия_ИО_группа`).

### 4.2 Создание рабочего пространства

1. На странице «Мои пространства» создайте новое рабочее пространство (например, «ЛР3 — Формулы»).
2. Перейдите в рабочую область.

### 4.3 Загрузка сценария

1. В верхней панели в выпадающем списке сценариев выберите `lab3_formulas`.
2. Нажмите кнопку **«Загрузить»**.
3. Дождитесь отображения графа семантической сети (6 узлов, 7 рёбер).
4. Убедитесь, что на панели «Переменные» отображаются три переменные: `student`, `course`, `teacher`.

### 4.4 Изучение справочных материалов

1. Нажмите кнопку **«?»** (справка) на панели инструментов.
2. Перейдите на вкладку **«Логика»**.
3. Изучите таблицы истинности для NOT, AND, OR, IMPLIES.
4. Обратите внимание на строки с UNKNOWN — именно они определяют поведение формул при неопределённых переменных.
5. Перейдите на вкладку **«Глоссарий»** и ознакомьтесь с определениями терминов «Формула» и «Форсинг».
6. Закройте справочную панель.

### 4.5 Создание первой формулы (FactAtom)

1. В правой панели найдите раздел **«Формулы»**.
2. Нажмите ссылку **«+ Новая формула»**.
3. В поле **«Имя формулы»** введите осмысленное название, например: `teaches_ivanov_db`.
4. В конструкторе формул выберите тип **FactAtom**.
5. В выпадающем списке предикатов выберите `teaches`.
6. В полях аргументов выберите: arg0 = `ivanov`, arg1 = `course_db`.
7. Нажмите кнопку **«Создать»**.
8. Формула появится в списке.

### 4.6 Вычисление формулы

1. Рядом с созданной формулой нажмите кнопку **«Вычислить»** (▶).
2. Результат отобразится в виде цветной метки:
   - **TRUE** (зелёный) — факт `teaches(ivanov, course_db)` присутствует в сети.
   - **FALSE** (красный) — факт отсутствует.
   - **UNKNOWN** (жёлтый) — невозможно определить.
3. Для формулы `teaches(ivanov, course_db)` ожидается результат **TRUE**.

### 4.7 Создание формулы с результатом FALSE

1. Создайте новую формулу типа FactAtom: `teaches(petrov, course_db)`.
2. Вычислите — ожидается результат **FALSE** (Петров не преподаёт).

### 4.8 Создание составной формулы (NOT)

1. Создайте новую формулу типа **Not**.
2. В качестве внутренней формулы укажите FactAtom: `teaches(petrov, course_db)`.
3. Вычислите — ожидается результат **TRUE** (отрицание FALSE даёт TRUE по таблице).

### 4.9 Создание составной формулы (AND)

1. Создайте формулу типа **And** с двумя подформулами:
   - `FactAtom("enrolled_in", petrov, course_db)` — TRUE
   - `FactAtom("studies_at", petrov, dept_cs)` — TRUE
2. Вычислите — ожидается результат **TRUE** (T ∧ T = T).

### 4.10 Создание формулы с результатом UNKNOWN

1. Создайте формулу, которая зависит от неопределённой переменной или от факта, истинность которого зависит от значения переменной `course`.
2. Например, используйте формулу AND:
   - `FactAtom("teaches", ivanov, course_db)` — TRUE
   - `FactAtom("teaches", ivanov, course_ai)` — TRUE
3. Либо создайте формулу, явно использующую переменную `course` в позиции аргумента.
4. Вычислите и убедитесь в получении результата **UNKNOWN**.
5. Объясните результат, ссылаясь на таблицу истинности и неопределённость переменной.

### 4.11 Создание формулы IMPLIES

1. Создайте формулу типа **Implies**:
   - Посылка: `FactAtom("works_at", ivanov, dept_cs)` — TRUE
   - Заключение: `FactAtom("teaches", ivanov, course_db)` — TRUE
2. Вычислите — ожидается результат **TRUE** (T → T = T).

### 4.12 Экспорт результатов

1. Нажмите кнопку **«Экспорт JSON»** на панели инструментов.
2. Сохраните файл — он содержит все созданные формулы и результаты вычислений.
3. Для экспорта графа нажмите **«Экспорт PNG»**.

## 5 Задание для самостоятельной работы

Создайте не менее **5 формул** различной сложности и заполните таблицу:

| № | Имя формулы | Тип | Текстовое представление | Ожидаемый результат | Фактический результат | Обоснование |
|---|-------------|-----|-------------------------|---------------------|-----------------------|-------------|
| 1 |             | FactAtom |                    |                     |                       |             |
| 2 |             | FactAtom |                    |                     |                       |             |
| 3 |             | Not      |                    |                     |                       |             |
| 4 |             | And / Or |                    |                     |                       |             |
| 5 |             | Implies  |                    |                     |                       |             |

Требования:
- Не менее 2 атомарных формул (FactAtom и/или EqAtom).
- Не менее 2 составных формул с разными связками (NOT, AND, OR, IMPLIES).
- Хотя бы 1 формула должна давать результат UNKNOWN.
- В столбце «Обоснование» укажите, какие строки таблиц истинности использовались для получения результата.

## 6 Требования к отчёту

Отчёт оформляется в соответствии с ГОСТ 7.32-2017 и должен содержать следующие разделы:

1. **Титульный лист** — наименование учебного заведения, кафедры, дисциплины; название работы; ФИО студента и преподавателя; год.
2. **Цель работы** — формулировка цели в соответствии с разделом 1 настоящей инструкции.
3. **Теоретическая часть** — краткое изложение основных понятий: трёхзначная логика Клини, атомарные формулы (FactAtom, EqAtom), логические связки (NOT, AND, OR, IMPLIES), вычисление формул.
4. **Ход работы** — пошаговое описание действий в системе CTMSN с приложением скриншотов:
   - Загруженный сценарий `lab3_formulas` (скриншот графа).
   - Скриншот справочной панели с таблицами истинности.
   - Скриншот каждой созданной формулы с результатом вычисления.
   - Скриншот формулы с результатом UNKNOWN.
5. **Результаты** — заполненная таблица формул (раздел 5); анализ каждого результата с обоснованием через таблицы истинности.
6. **Выводы** — заключение о проделанной работе, соответствие результатов поставленной цели.
7. **Приложения** — экспортированный JSON-файл рабочего пространства.

## 7 Контрольные вопросы

1. Какие значения может принимать формула в трёхзначной логике Клини? В каких случаях возникает значение UNKNOWN?
2. Что проверяет атомарная формула FactAtom? Приведите пример.
3. Чем FactAtom отличается от EqAtom?
4. Запишите таблицу истинности для NOT в трёхзначной логике. Чему равно ¬UNKNOWN?
5. Запишите таблицу истинности для AND. При каких значениях A и B результат A ∧ B равен FALSE, даже если одно из значений UNKNOWN?
6. При каких значениях A импликация A → B всегда истинна независимо от B? Объясните через таблицу истинности.
7. Опишите алгоритм вычисления составной формулы `And(FactAtom(...), Not(FactAtom(...)))`. Какие шаги выполняет Evaluator?
