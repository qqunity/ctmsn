# ะกัะตะฝะฐัะธะน: ะะตัะตัั ััะฑ (Fish Spawning, 4.15)

> **ะะฐะฒะธะณะฐัะธั:** [๐ ะะปะฐะฒะฝะฐั](../../../../../README.md) | [๐ ะกัะตะฝะฐัะธะธ](../../scenarios/README.md) | **ะั ะทะดะตัั: Spawn**

## ะะฟะธัะฐะฝะธะต ะทะฐะดะฐัะธ

ะะพะดะตะปะธัะพะฒะฐะฝะธะต ะฟัะพัะตััะฐ ะฝะตัะตััะฐ ััะฑ ั ะธะทะผะตะฝะตะฝะธะตะผ ัะพะปะตะน (ัะฐะผะบะฐ/ัะฐะผะตั) ะธ ะฟะพะฒะตะดะตะฝะธั (ะฟะพะตะดะฐะฝะธะต ะธะบัั) ัะตัะตะท ััะฐะดะธะธ ัะฐะทะฒะธัะธั A โ B โ C.

### ะัะฝะพะฒะฝัะต ะบะพะฝัะตะฟัะธะธ

**ะกะพััะพัะฝะธั ััะฑ:**
- `Fish` โ ะฑะฐะทะพะฒะพะต ัะพััะพัะฝะธะต "ััะฑะฐ"
- `Fish_minus` (Fishโป) โ ััะฑั, ะฝะต ะตะดััะธะต ะธะบัั
- `Fish_plus` (Fishโบ) โ ััะฑั, ะตะดััะธะต ะธะบัั

**ะะพะปะธ:**
- `spawner` = not-eat โ fish โ ัะฐะผะบะฐ (ะฝะต ะตัั ะธะบัั)
- `milter` = eat โ fish โ ัะฐะผะตั (ะตัั ะธะบัั)

**ะะพะฒะตะดะตะฝัะตัะบะธะต ะพะฟะตัะฐัะพัั:**
- `push` โ ะพััะฐะปะบะธะฒะฐะฝะธะต ัะฐะผัะพะฒ (Fishโบ โ Fishโป)
- `rethink` โ ะฟะตัะตะดัะผะฐัั (Fishโป โ Fishโบ)

**ะกัะฐะดะธะธ ะฟัะพัะตััะฐ:**
- A โ ะฝะฐัะฐะปัะฝะฐั ััะฐะดะธั
- B โ ะฟัะพะผะตะถััะพัะฝะฐั (ะฟะพัะปะต ัะฐะทะฒะธัะธั `f`)
- C โ ัะธะฝะฐะปัะฝะฐั (ะฟะพัะปะต ัะฐะทะฒะธัะธั `e`)

### ะะฐะฝะพะฝะธัะตัะบะธะต ัะฐะฒะตะฝััะฒะฐ

ะะฐ ััะฐะดะธะธ A:
```
spawner = not-eat โ fish
milter = eat โ fish
```

ะะฐ ััะฐะดะธะธ B (ะฟะพัะปะต ัะฐะทะฒะธัะธั f):
```
push โ milter_f = spawner_f
rethink โ spawner_f = milter_f
rethink โ push โ milter_f = milter_f
```

ะะฐ ััะฐะดะธะธ C (ะฟะพัะปะต ัะฐะทะฒะธัะธั f โ e):
```
(rethink โ spawner_f)_e = (milter_f)_e
```

## ะกัััะบัััะฐ ััะตะฝะฐัะธั

```
spawn/
โโโ model.py          # ะัะฐั: ัะทะปั, ัััะตะปะบะธ, ะบะพะฝัะตะบััั
โโโ derive.py         # ะัะฒะพะด ะบะพะผะฟะพะทะธัะธะน ะธ ะฟัะพััะถะบะฐ ะฟะพ ะฒัะตะผะตะฝะธ
โโโ constraints.py    # ะฃัะปะพะฒะธั (ะบะฐะฝะพะฝะธัะตัะบะธะต ัะฐะฒะตะฝััะฒะฐ)
โโโ goal.py           # ะฆะตะปะตะฒะฐั ัะพัะผัะปะฐ
โโโ explain.py        # ะะฑัััะฝะตะฝะธั ะฒัะฒะพะดะพะฒ
โโโ runner.py         # ะะปะฐะฒะฝัะน ะทะฐะฟััะบ
โโโ README.md         # ะญัะฐ ะดะพะบัะผะตะฝัะฐัะธั
```

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

```python
from ctmsn.scenarios.spawn.runner import run

result = run()

print("Derivation:", result["derivation"])
print("Check:", result["check"].ok)
print("Forces:", result["forces"].value)
print("Explanations:", result["explain"])
```

## ะะตะผะพะฝัััะฐัะธั

ะะฐะฟััะบ ะฟัะธะผะตัะฐ:

```bash
python3 src/ctmsn/examples/spawn_demo.py
```

ะะถะธะดะฐะตะผัะน ะฒัะฒะพะด:

```
=== SPAWN (4.15) canonical ===
Derivation: {'derived_edges_added': 5, 'comp2_added': 18, ...}
Check ok: True | violated: [] | unknown: []
forces(phi): true
force(phi): true | Already forced

Explain:
  - spawner = not_eat โ fish (ัะตัะตะท Fish)
  - milter = eat โ fish (ัะตัะตะท Fish)
  - spawner_f = push โ milter_f (ัะตัะตะท Fish_plus)
  - milter_f = rethink โ spawner_f (ัะตัะตะท Fish_minus)
  - milter_f = rethinkโpushโmilter_f (trace: ...)
  - milter_fe = (rethinkโspawner_f)_e (trace: ...)
```

## ะขะตัะฝะธัะตัะบะฐั ัะตะฐะปะธะทะฐัะธั

### ะญัะฐะฟ D1: ะัะพััะถะบะฐ ัััะตะปะพะบ ะฟะพ ะฒัะตะผะตะฝะธ

ะัะปะธ ะตััั `f: B โ A` ะธ `spawner: A โ Fish_minus`, ะฒัะฒะพะดะธะผ:
```
derived_edge("spawner_f", B, Fish_minus)
```

ะะฝะฐะปะพะณะธัะฝะพ ะดะปั `e: C โ B`:
```
derived_edge("spawner_fe", C, Fish_minus)
```

### ะญัะฐะฟ D2: ะัะฒะพะด ะบะพะผะฟะพะทะธัะธะน

**D2.1 โ comp2 (ะดะฒัััะฐะณะพะฒัะต):**

ะะปั ะฟััะธ `X -left-> Y -right-> Z` ะธ ะธะผะตะฝะพะฒะฐะฝะฝะพะณะพ ัะตะทัะปััะฐัะฐ `X -result-> Z` ะฒัะฒะพะดะธะผ:
```
comp2(left, right, result)
comp2_expl(left, right, result, mid=Y)
```

**D2.2 โ compN (ะผะฝะพะณะพัะฐะณะพะฒัะต):**

ะะปั ัะตะฟะพัะบะธ ะธะท N ัะฐะณะพะฒ ะฟัะพะฒะตััะตะผ ะฟััั ะธ ััะฐะฒะฝะธะฒะฐะตะผ ั ะธะผะตะฝะพะฒะฐะฝะฝัะผ ัะตะทัะปััะฐัะพะผ:
```
compN("rethinkโpushโmilter_f", "milter_f")
compN("(rethinkโspawner_f)_e", "milter_fe")
```

## ะกะผ. ัะฐะบะถะต

> **ะกะผ. ัะฐะบะถะต:**
> - [SPAWN_IMPLEMENTATION.md](../../../../../SPAWN_IMPLEMENTATION.md) โ ัะตัะฝะธัะตัะบะพะต ะพะฟะธัะฐะฝะธะต
> - [USAGE.md](../../../../../USAGE.md#ััะตะฝะฐัะธะน-spawn-ะฝะตัะตัั-ััะฑ-415) โ ะฟัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั
> - [ะกัะตะฝะฐัะธะธ](../../scenarios/README.md) โ ะพะฑะทะพั ะฒัะตั ััะตะฝะฐัะธะตะฒ

---

> **ะะฐะฒะธะณะฐัะธั:** [๐ ะะปะฐะฒะฝะฐั](../../../../../README.md) | [๐ ะกัะตะฝะฐัะธะธ](../../scenarios/README.md) | **ะั ะทะดะตัั: Spawn**
